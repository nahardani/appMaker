<!DOCTYPE html>
<html lang="fa" dir="rtl" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>مدیریت پرامپت‌ها</title>
    <link rel="stylesheet" th:href="@{/css/style.css}" href="/css/style.css"/>
    <style>
        .tag{background:#223247;color:#cfe9ff;padding:2px 6px;border-radius:8px;margin-inline-end:6px}
        .muted{opacity:.8;font-size:12px}
        table{width:100%} th,td{padding:6px 8px}
        .actions a,.actions form{display:inline-block;margin-inline-end:6px}
    </style>
</head>
<body>
<div class="header"><h1>Value Objects</h1>
    <div>
        <a th:href="@{/home}">بازگشت</a>
        <a th:href="@{/prompts/new}" class="btn btn-primary" style="margin-inline-start:8px">جدید</a>
    </div>
</div>

<div class="container">
    <div class="card">
        <form class="form" th:action="@{/prompts}" method="get" style="display:grid;grid-template-columns:repeat(4,1fr);gap:8px;">
            <div>
                <label>دسته</label>
                <select name="category">

                    <option th:each="c : ${categories}"
                            th:value="${c}" th:text="${c}"
                            th:selected="${c == category}">controller</option>
                </select>
            </div>
            <div>
                <label>هدف</label>
                <select name="target">
                    <option th:each="t : ${targets}"
                            th:value="${t}" th:text="${t}"
                            th:selected="${t == target}">CONTROLLER</option>
                </select>
            </div>
            <div>
                <label>نسخه جاوا</label>
                <select name="java">
                    <option th:each="v : ${javaVersions}"
                            th:value="${v}" th:text="${v}"
                            th:selected="${v == java}">17</option>
                </select>
            </div>
            <div style="align-self:end">
                <button class="btn">فیلتر</button>
                <a class="btn btn-primary" th:href="@{/prompts/new}">پرامپت جدید</a>
            </div>
        </form>

    </div>

    <div class="card" style="margin-top:12px;">
        <table>
            <thead>
            <tr>
                <th>نام</th><th>دسته</th><th>هدف</th><th>اسکوپ</th><th>جاوا</th><th>برچسب‌ها</th><th>وضعیت</th><th></th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="p : ${prompts}">
                <td th:text="${p.name}">Controller + Service</td>
                <td th:text="${p.category}">controller</td>
                <td th:text="${p.target}">CONTROLLER</td>
                <td th:text="${p.scope}">GLOBAL</td>
                <td>
                    <span th:text="${p.javaMin}">11</span>–<span th:text="${p.javaMax}">21</span>
                </td>
                <td>
                    <span th:each="t : ${#strings.arraySplit(p.tags==null?'':p.tags,',')}" class="tag" th:text="${t}">rest</span>
                </td>
                <td th:text="${p.status}">ACTIVE</td>
                <td class="actions">
                    <a class="btn btn-secondary" th:href="@{'/prompts/' + ${p.id} + '/edit'}">ویرایش</a>
                    <form th:action="@{'/prompts/' + ${p.id} + '/archive'}" method="post" th:if="${p.status.name()!='ARCHIVED'}" style="display:inline">
                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                        <button class="btn">آرشیو</button>
                    </form>
                </td>
            </tr>
            <tr th:if="${#lists.isEmpty(prompts)}">
                <td colspan="8" class="muted">موردی یافت نشد.</td>
            </tr>
            </tbody>
        </table>
    </div>
</div>
</body>
</html>