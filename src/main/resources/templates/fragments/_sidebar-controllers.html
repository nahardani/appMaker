<!— fragments/_sidebar-controllers.html —>
<div th:fragment="sidebar(project)">
    <div class="card">
        <div class="card-head">
            <h3>فهرست کنترلرها</h3>
            <a th:href="@{'/wizard/' + ${project.id} + '/controllers'}" class="btn btn-secondary">+ کنترلر جدید</a>
        </div>

        <ul class="list">
            <li th:each="c : ${project.controllers}" class="list-row">
                <a th:href="@{'/wizard/' + ${project.id} + '/controllers?ctrl=' + ${c.name}}"
                   class="btn btn-secondary list-link">
                    <span th:text="${c.name}">OrderController</span>
                    <span class="chip" th:text="${#lists.size(c.endpoints)} + ' ep'">0 ep</span>
                </a>
                <form th:action="@{'/wizard/' + ${project.id} + '/controllers/' + ${c.name} + '/delete'}"
                      method="post" class="inline"
                      th:attr="onsubmit=|return confirm('حذف کنترلر «${c.name}»؟');|">
                    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                    <button type="submit" class="icon-btn" title="حذف کنترلر" aria-label="حذف کنترلر">
                        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8">
                            <path stroke-linecap="round" stroke-linejoin="round"
                                  d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m3 0V5
                         a2 2 0 012-2h4a2 2 0 012 2v2m-6 4v6m4-6v6M4 7h16"/>
                        </svg>
                    </button>
                </form>
            </li>

            <li th:if="${project.controllers == null or #lists.isEmpty(project.controllers)}"
                class="muted" style="padding:8px 2px">
                هنوز کنترلری ساخته نشده است.
            </li>
        </ul>
    </div>
</div>
